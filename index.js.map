{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport { refs } from '../main';\n\nexport async function getPhotos(query, page = 1) {\n  const ENDPOINT = 'https://pixabay.com/api/';\n  const API_KEY = '51376542-95e34f1d639dab3c27f4a47b0';\n\n  const queryParams = new URLSearchParams({\n    q: query,\n    key: API_KEY,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: refs.per_page,\n    page: page,\n  });\n\n  try {\n    const respData = await axios.get(`${ENDPOINT}?${queryParams}`);\n    return respData.data;\n  } catch (err) {\n    throw err;\n  }\n}\n","import SimpleLightbox from 'simplelightbox';\nimport { refs } from '../main';\n\nconst simpleGallery = new SimpleLightbox('.gallery a');\n\nexport function createGallery(images) {\n  const dynamicMarkup = images\n    .map(\n      item =>\n        `<li><a class=\"img-link\" href=\"${item.largeImageURL}\"><img src=\"${item.webformatURL}\" alt=\"${item.tags}\" width=\"360\" height=\"200\"><ul class=\"img-meta\">\n      <li class=\"meta-list-item\"><span class=\"meta-item-title\">Likes</span> ${item.likes}</li>\n      <li class=\"meta-list-item\"><span class=\"meta-item-title\">Views</span> ${item.views}</li>\n      <li class=\"meta-list-item\"><span class=\"meta-item-title\">Comments</span> ${item.comments}</li>\n      <li class=\"meta-list-item\"><span class=\"meta-item-title\">Downloads</span> ${item.downloads}</li>\n      </ul>\n      </a>\n      </li>`\n    )\n    .join('');\n  refs.galleryEl.insertAdjacentHTML('beforeend', dynamicMarkup);\n  simpleGallery.refresh();\n}\n\n// Utilities\nexport function clearGallery() {\n  refs.galleryEl.innerHTML = '';\n}\n\nexport function showLoader() {\n  refs.loaderEl.classList.remove('is-hidden');\n}\n\nexport function hideLoader() {\n  refs.loaderEl.classList.add('is-hidden');\n}\n\nexport function showLoadMoreButton() {\n  refs.loadMoreBtn.classList.remove('is-hidden');\n}\n\nexport function hideLoadMoreButton() {\n  refs.loadMoreBtn.classList.add('is-hidden');\n}\n","import iziToast from 'izitoast';\nimport { getPhotos } from './js/pixabay-api';\nimport {\n  clearGallery,\n  createGallery,\n  hideLoader,\n  hideLoadMoreButton,\n  showLoader,\n  showLoadMoreButton,\n} from './js/render-functions';\n\n//--- References ---\nexport const refs = {\n  formEl: document.querySelector('.form'),\n  galleryEl: document.querySelector('.gallery'),\n  loadMoreBtn: document.querySelector('.load-more-btn'),\n  loaderEl: document.querySelector('.loader'),\n  per_page: 15, // Per page value for pixabay-api and show 'Load more' button logic\n};\n\n//--- Global Variables ---\nlet currentSearchQuery = '';\nlet currentPage = 1;\nlet maxPageCount = 1;\n\n//--- Handlers ---\n// Search query validaton\nasync function onSubmit(event) {\n  event.preventDefault();\n  clearGallery();\n  let respData = null; // onSubmit scope availability for respData\n\n  const searchQuery = event.target.elements['search-text'].value.trim();\n  if (!searchQuery) {\n    return iziToast.error({\n      message: 'Empty request. Try again!',\n      position: 'topRight',\n    });\n  }\n  currentSearchQuery = searchQuery; // Assign validated search query value to the global variable;\n\n  hideLoadMoreButton();\n  showLoader();\n\n  // Server response processing & gallery markup insertion\n  currentPage = 1; // reset page counter for a new submit\n  try {\n    respData = await getPhotos(searchQuery, currentPage);\n    const hits = respData.hits;\n\n    if (hits.length === 0) {\n      return iziToast.error({\n        message:\n          'Sorry there are no images matching your search query. Please try again!',\n        position: 'topRight',\n      });\n    }\n\n    createGallery(hits);\n  } catch (err) {\n    iziToast.error({\n      message: err.message,\n      position: 'topRight',\n    });\n  } finally {\n    hideLoader();\n    // Check if there is more images to show on the next page\n    maxPageCount = Math.ceil(respData.totalHits / refs.per_page);\n\n    if (respData.totalHits > refs.per_page) {\n      showLoadMoreButton();\n    }\n  }\n\n  event.target.reset();\n}\n\n// Load more button logic\nasync function onClickLoadMoreBtn() {\n  hideLoadMoreButton();\n  showLoader();\n\n  currentPage += 1;\n\n  try {\n    const respNextData = await getPhotos(currentSearchQuery, currentPage);\n    const nextHits = respNextData.hits;\n\n    createGallery(nextHits);\n    // Scroll behaviour //\n    const galleryItemEl = document.querySelector('.gallery li');\n    const galleryItemHeight = galleryItemEl.getBoundingClientRect().height;\n    window.scrollBy({\n      top: galleryItemHeight * 2,\n      left: 0,\n      behavior: 'smooth',\n    });\n    // End of scroll behaviour\n  } catch (err) {\n    iziToast.error({ message: err.message, position: 'topRight' });\n  } finally {\n    hideLoader();\n\n    if (currentPage >= maxPageCount) {\n      hideLoadMoreButton();\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n    } else {\n      showLoadMoreButton();\n    }\n  }\n}\n\n//--- Event Listeners ---\nrefs.formEl.addEventListener('submit', onSubmit);\nrefs.loadMoreBtn.addEventListener('click', onClickLoadMoreBtn);\n"],"names":["getPhotos","query","page","ENDPOINT","API_KEY","queryParams","refs","axios","err","simpleGallery","SimpleLightbox","createGallery","images","dynamicMarkup","item","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","currentSearchQuery","currentPage","maxPageCount","onSubmit","event","respData","searchQuery","iziToast","hits","onClickLoadMoreBtn","nextHits","galleryItemHeight"],"mappings":"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"}